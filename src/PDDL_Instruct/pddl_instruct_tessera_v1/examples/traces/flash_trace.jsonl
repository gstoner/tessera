{"step": 1, "action": "SELECT-ALGORITHM(flash-attention)", "applicable": true, "reason": ["sequence_length=2048 implies O(S^2) memory; choose memory-efficient algorithm"], "effects": {"add": ["algorithm=flash-attention"], "del": []}, "constraints": {"shared_memory_bytes": 0, "limit_shared_memory_bytes": 228000, "registers_per_thread": 64, "limit_registers_per_thread": 255, "occupancy_target_met": true, "occupancy_estimate": 0.75}, "estimates": {"achieved_tflops": 950.0}, "state_hash": "sha256:demo"}
{"step": 2, "action": "SET-TILE-SIZE(128,128)", "applicable": true, "reason": ["Q,K,V tiles fit in 96KB < 228KB"], "effects": {"add": ["tile-size=128x128"], "del": ["tile-size=?"]}, "constraints": {"shared_memory_bytes": 98304, "limit_shared_memory_bytes": 228000, "registers_per_thread": 96, "limit_registers_per_thread": 255, "occupancy_target_met": true, "occupancy_estimate": 0.72}, "estimates": {"achieved_tflops": 1200.0}, "state_hash": "sha256:demo2"}
{"step": 3, "action": "USE-WGMMA(m64n256k32)", "applicable": true, "reason": ["head_dim=128 divisible by k=32; prefer WGMMA"], "effects": {"add": ["compute=wgmma"], "del": ["compute=?"]}, "constraints": {"shared_memory_bytes": 98304, "limit_shared_memory_bytes": 228000, "registers_per_thread": 110, "limit_registers_per_thread": 255, "occupancy_target_met": true, "occupancy_estimate": 0.68}, "estimates": {"achieved_tflops": 1300.0}, "state_hash": "sha256:demo3"}
